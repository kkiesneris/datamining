CREATE OR REPLACE VIEW transaction_vw (
    arn,
    authorizer,
    card_brand,
    card_issuer,
    card_network,
    card_type,
    condition_code,
    country_code,
    destination,
    entry_mode,
    expiry_date,
    mcc,
    merchant_id,
    msg_type,
    pan,
    reversal_code,
    terminal_city,
    terminal_id,
    tran_category,
    tran_code,
    tran_date,
    transaction_id,
    able_to_enter_pin,
    amount,
    amount_diff,
    cnp_day_avg_01d,
    cnp_day_avg_30d,
    cnp_day_avg_60d,
    cnp_day_avg_07d,
    cnp_tran_avg_01d,
    cnp_tran_avg_30d,
    cnp_tran_avg_60d,
    cnp_tran_avg_07d,
    country_day_avg_01d,
    country_day_avg_30d,
    country_day_avg_60d,
    country_day_avg_07d,
    country_tran_avg_01d,
    country_tran_avg_30d,
    country_tran_avg_60d,
    country_tran_avg_07d,
    all_day_avg_01d,
    all_day_avg_30d,
    all_day_avg_60d,
    all_day_avg_07d,
    mcc_day_avg_01d,
    mcc_day_avg_30d,
    mcc_day_avg_60d,
    mcc_day_avg_07d,
    mcc_tran_avg_01d,
    mcc_tran_avg_30d,
    mcc_tran_avg_60d,
    mcc_tran_avg_07d,
    merchant_day_avg_01d,
    merchant_day_avg_30d,
    merchant_day_avg_60d,
    merchant_day_avg_07d,
    merchant_tran_avg_01d,
    merchant_tran_avg_30d,
    merchant_tran_avg_60d,
    merchant_tran_avg_07d,
    nochip_day_avg_01d,
    nochip_day_avg_30d,
    nochip_day_avg_60d,
    nochip_day_avg_07d,
    nochip_tran_avg_01d,
    nochip_tran_avg_30d,
    nochip_tran_avg_60d,
    nochip_tran_avg_07d,
    all_tran_avg_01d,
    all_tran_avg_30d,
    all_tran_avg_60d,
    all_tran_avg_07d,
    card_not_present,
    all_count_10m,
    all_count_01d,
    all_count_30d,
    all_count_60d,
    all_count_60m,
    all_count_07d,
    cnp_count_10m,
    cnp_count_01d,
    cnp_count_30d,
    cnp_count_60d,
    cnp_count_60m,
    cnp_count_07d,
    country_count_10m,
    country_count_01d,
    country_count_30d,
    country_count_60d,
    country_count_60m,
    country_count_07d,
    declined_count_10m,
    declined_count_01d,
    declined_count_30d,
    declined_count_60d,
    declined_count_60m,
    declined_count_07d,
    mcc_count_10m,
    mcc_count_01d,
    mcc_count_30d,
    mcc_count_60d,
    mcc_count_60m,
    mcc_count_07d,
    merchant_count_10m,
    merchant_count_01d,
    merchant_count_30d,
    merchant_count_60d,
    merchant_count_60m,
    merchant_count_07d,
    nochip_count_10m,
    nochip_count_01d,
    nochip_count_30d,
    nochip_count_60d,
    nochip_count_60m,
    nochip_count_07d,
    first_cnp_tran,
    first_country_tran,
    first_declined_tran,
    first_mcc_tran,
    first_merchant_tran,
    first_nochip_tran,
    first_tran,
    fraud,
    high_risk_mcc,
    neighbouring_country,
    pan_from_chip,
    pin_present,
    pin_tries,
    previous_tran_declined,
    same_country,
    same_merchant,
    sepa_country,
    all_sum_01d,
    all_sum_30d,
    all_sum_60d,
    all_sum_07d,
    cnp_sum_01d,
    cnp_sum_30d,
    cnp_sum_60d,
    cnp_sum_07d,
    country_sum_01d,
    country_sum_30d,
    country_sum_60d,
    country_sum_07d,
    mcc_sum_01d,
    mcc_sum_30d,
    mcc_sum_60d,
    mcc_sum_07d,
    merchant_sum_01d,
    merchant_sum_30d,
    merchant_sum_60d,
    merchant_sum_07d,
    nochip_sum_01d,
    nochip_sum_30d,
    nochip_sum_60d,
    nochip_sum_07d,
    time_since_prev_country_tran,
    time_since_prev_mcc_tran,
    time_since_prev_merchant_tran,
    time_since_prev_tran,
    tran_at_night,
    tran_declined
) AS
    SELECT
        arn,
        authorizer,
        card_brand,
        card_issuer,
        card_network,
        card_type,
        condition_code,
        country_code,
        destination,
        entry_mode,
        expiry_date,
        mcc,
        merchant_id,
        msg_type,
        pan,
        reversal_code,
        terminal_city,
        terminal_id,
        tran_category,
        tran_code,
        tran_date,
        transaction_id,
        able_to_enter_pin,
        amount,
        amount_diff,
        avg_cnp_day_amount_1d,
        avg_cnp_day_amount_30d,
        avg_cnp_day_amount_60d,
        avg_cnp_day_amount_7d,
        avg_cnp_tran_amount_1d,
        avg_cnp_tran_amount_30d,
        avg_cnp_tran_amount_60d,
        avg_cnp_tran_amount_7d,
        avg_country_day_amount_1d,
        avg_country_day_amount_30d,
        avg_country_day_amount_60d,
        avg_country_day_amount_7d,
        avg_country_tran_amount_1d,
        avg_country_tran_amount_30d,
        avg_country_tran_amount_60d,
        avg_country_tran_amount_7d,
        avg_day_amount_1d,
        avg_day_amount_30d,
        avg_day_amount_60d,
        avg_day_amount_7d,
        avg_mcc_day_amount_1d,
        avg_mcc_day_amount_30d,
        avg_mcc_day_amount_60d,
        avg_mcc_day_amount_7d,
        avg_mcc_tran_amount_1d,
        avg_mcc_tran_amount_30d,
        avg_mcc_tran_amount_60d,
        avg_mcc_tran_amount_7d,
        avg_merchant_day_amount_1d,
        avg_merchant_day_amount_30d,
        avg_merchant_day_amount_60d,
        avg_merchant_day_amount_7d,
        avg_merchant_tran_amount_1d,
        avg_merchant_tran_amount_30d,
        avg_merchant_tran_amount_60d,
        avg_merchant_tran_amount_7d,
        avg_nochip_day_amount_1d,
        avg_nochip_day_amount_30d,
        avg_nochip_day_amount_60d,
        avg_nochip_day_amount_7d,
        avg_nochip_tran_amount_1d,
        avg_nochip_tran_amount_30d,
        avg_nochip_tran_amount_60d,
        avg_nochip_tran_amount_7d,
        avg_tran_amount_1d,
        avg_tran_amount_30d,
        avg_tran_amount_60d,
        avg_tran_amount_7d,
        card_not_present,
        count_10m,
        count_1d,
        count_30d,
        count_60d,
        count_60m,
        count_7d,
        count_cnp_10m,
        count_cnp_1d,
        count_cnp_30d,
        count_cnp_60d,
        count_cnp_60m,
        count_cnp_7d,
        count_country_10m,
        count_country_1d,
        count_country_30d,
        count_country_60d,
        count_country_60m,
        count_country_7d,
        count_declined_10m,
        count_declined_1d,
        count_declined_30d,
        count_declined_60d,
        count_declined_60m,
        count_declined_7d,
        count_mcc_10m,
        count_mcc_1d,
        count_mcc_30d,
        count_mcc_60d,
        count_mcc_60m,
        count_mcc_7d,
        count_merchant_10m,
        count_merchant_1d,
        count_merchant_30d,
        count_merchant_60d,
        count_merchant_60m,
        count_merchant_7d,
        count_nochip_10m,
        count_nochip_1d,
        count_nochip_30d,
        count_nochip_60d,
        count_nochip_60m,
        count_nochip_7d,
        first_cnp_tran,
        first_country_tran,
        first_declined_tran,
        first_mcc_tran,
        first_merchant_tran,
        first_nochip_tran,
        first_tran,
        fraud,
        high_risk_mcc,
        neighbouring_country,
        pan_from_chip,
        pin_present,
        pin_tries,
        previous_tran_declined,
        same_country,
        same_merchant,
        sepa_country,
        sum_1d,
        sum_30d,
        sum_60d,
        sum_7d,
        sum_cnp_1d,
        sum_cnp_30d,
        sum_cnp_60d,
        sum_cnp_7d,
        sum_country_1d,
        sum_country_30d,
        sum_country_60d,
        sum_country_7d,
        sum_mcc_1d,
        sum_mcc_30d,
        sum_mcc_60d,
        sum_mcc_7d,
        sum_merchant_1d,
        sum_merchant_30d,
        sum_merchant_60d,
        sum_merchant_7d,
        sum_nochip_1d,
        sum_nochip_30d,
        sum_nochip_60d,
        sum_nochip_7d,
        time_since_prev_country_tran,
        time_since_prev_mcc_tran,
        time_since_prev_merchant_tran,
        time_since_prev_tran,
        tran_at_night,
        tran_declined
    FROM
        transactions_2;
